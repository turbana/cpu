{
	"execute_barrel_shifter": {
		"delay": 162,
		"inputs": {
			"_E_A":    {"width": 16, "alias": "n"},
			"_E_B":    {"width": 16},
			"D_ALUop": {"width": 3}
		},
		"assert": "(D_ALUop & 3) != 3",
		"internal": {
			"s": "_E_B & 0xF",
			"r": "(~D_ALUop & 2) >> 1",
			"a": "D_ALUop & 1"
		},
		"outputs": {
			"_E_S": {
				"width": 16,
				"formula": "((n>>s)|((2**16 - 2**(16-s)) * (n>>15))) if r and a else ((n>>s) if r else (n<<s))"
			}
		}
	},
	"execute_barrel_shifter_old": {
		"delay": 162,
		"inputs": {
			"ALU_BS_A":  {"width": 16, "alias": "n"},
			"ALU_BS_S":  {"width": 4,  "alias": "s"},
			"ALU_BS_R":  {"width": 1,  "alias": "r"},
			"ALU_BS_SA": {"width": 1,  "alias": "a"}
		},
		"assert": "not (r==0 and a==1)",
		"outputs": {
			"ALU_BS_D": {
				"width": 16,
				"formula": "((n>>s)|((2**16 - 2**(16-s)) * (n>>15))) if r and a else ((n>>s) if r else (n<<s))"
			}
		}
	},
	"execute_control": {
		"delay": 27,
		"inputs": {
			"M_S":  {"width": 1},
			"D_Rd": {"width": 3},
			"D_J":  {"width": 1},
			"D_Mr": {"width": 3},
			"D_Mw": {"width": 3},
			"D_S":  {"width": 1}
		},
		"outputs": {
			"_E_Rd": {"width": 3, "formula": "0 if M_S else D_Rd"},
			"_E_J":  {"width": 1, "formula": "0 if M_S else D_J"},
			"_E_Mr": {"width": 1, "formula": "0 if M_S else D_Mr"},
			"_E_Mw": {"width": 1, "formula": "0 if M_S else D_Mw"},
			"_E_S":  {"width": 1, "formula": "0 if M_S else D_S"}
		}
	},
	"execute_forward": {
		"delay": 84,
		"inputs": {
			"D_A":  {"width": 16},
			"D_B":  {"width": 16},
			"D_C":  {"width": 16},
			"D_Ra": {"width": 3},
			"D_Rb": {"width": 3},
			"D_Rc": {"width": 3},
			"E_D":  {"width": 16},
			"E_Rd": {"width": 3},
			"M_D":  {"width": 16},
			"M_Rd": {"width": 3}
		},
		"internal": {
			"ea": "E_Rd ^ D_Ra == 0",
			"eb": "E_Rd ^ D_Rb == 0",
			"ec": "E_Rd ^ D_Rc == 0",
			"ma": "M_Rd ^ D_Ra == 0",
			"mb": "M_Rd ^ D_Rb == 0",
			"mc": "M_Rd ^ D_Rc == 0"
		},
		"outputs": {
			"F_A": {"width": 16, "formula": "E_D if ea else (M_D if ma else D_A)"},
			"F_B": {"width": 16, "formula": "E_D if eb else (M_D if mb else D_B)"},
			"F_C": {"width": 16, "formula": "E_D if ec else (M_D if mc else D_C)"}
		}
	},
	"execute_alu": {
		"delay": 1000,
		"inputs": {
			"F_A": {"width": 16, "alias": "a"},
			"F_B": {"width": 16, "alias": "b"},
			"D_ALUop": {"width": 3, "alias": "op"}
		},
		"assert": "op in (0, 1)",
		"outputs": {
			"E_D": {
				"width": 16,
				"formula": "a+b if op==0 else (a&b if op ==1 else 0)"
			}
		}
	},
	"execute_add": {
		"delay": 320,
		"inputs": {
			"F_A":   {"width": 16},
			"F_B":   {"width": 16}
		},
		"outputs": {
			"_E_add": {"width": 16, "formula": "F_A + F_B"}
		}
	},
	"execute_and": {
		"delay": 27,
		"inputs": {
			"F_A":   {"width": 16},
			"F_B":   {"width": 16}
		},
		"outputs": {
			"_E_and": {"width": 16, "formula": "F_A & F_B"}
		}
	},
	"ic7408": {
		"delay": 27,
		"inputs": {
			"A": {"width": 4},
			"B": {"width": 4}
		},
		"outputs": {
			"X": {"width": 4, "formula": "A & B"}
		}
	},
	"ic7432": {
		"delay": 10,
		"inputs": {
			"A": {"width": 4},
			"B": {"width": 4}
		},
		"outputs": {
			"X": {"width": 4, "formula": "A | B"}
		}
	},
	"ic7486": {
		"delay": 30,
		"inputs": {
			"A": {"width": 4},
			"B": {"width": 4}
		},
		"outputs": {
			"X": {"width": 4, "formula": "A ^ B"}
		}
	},
	"ic74153": {
		"delay": 34,
		"inputs": {
			"A": {"width": 2},
			"B": {"width": 2},
			"C": {"width": 2},
			"D": {"width": 2},
			"S": {"width": 2}
		},
		"outputs": {
			"X": {"width": 2, "formula": "A if S==0 else (B if S==1 else (C if S==2 else D))"}
		}
	},
	"ic74283": {
		"delay": 320,
		"inputs": {
			"A":   {"width": 16},
			"B":   {"width": 16},
			"Cin": {"width": 1}
		},
		"outputs": {
			"X":    {"width": 16, "formula": "A + B + Cin"},
			"Cout": {"width": 1,  "formula": "(A + B) >> 16"}
		}
	},
	"mux16x4": {
		"delay": 34,
		"inputs": {
			"A": {"width": 16},
			"B": {"width": 16},
			"C": {"width": 16},
			"D": {"width": 16},
			"S": {"width": 2}
		},
		"outputs": {
			"X": {"width": 16, "formula": "A if S==0 else (B if S==1 else (C if S==2 else D))"}
		}
	}

	,"test": {
		"delay": 1000,
		"inputs": {
			"A":   {"width": 4},
			"B":   {"width": 4},
			"Cin": {"width": 1}
		},
		"outputs": {
			"X":    {"width": 4, "formula": "A + B + Cin"},
			"Cout": {"width": 1, "formula": "(A + B + Cin) >> 4"}
		}
	}
}
